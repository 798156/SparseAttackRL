# å®Œæ•´å®éªŒçŸ©é˜µä½¿ç”¨æŒ‡å—

## ğŸ¯ æ¦‚è¿°

å®Œæ•´å®éªŒçŸ©é˜µå®ç°äº†è®ºæ–‡æ‰€éœ€çš„æ‰€æœ‰å®éªŒç»„åˆï¼š
- **3ä¸ªæ•°æ®é›†**ï¼šCIFAR-10, CIFAR-100, ImageNetï¼ˆå¯é€‰ï¼‰
- **4ä¸ªæ¨¡å‹**ï¼šResNet18, VGG16, MobileNetV2, DenseNet121
- **4ç§æ–¹æ³•**ï¼šSparseAttackRL V2, JSMA, One-Pixel, SparseFool
- **500ä¸ªæ ·æœ¬/æ•°æ®é›†**

---

## ğŸ“ æ–°å¢æ–‡ä»¶

### æ ¸å¿ƒå®ç°

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `sparsefool_attack.py` | SparseFoolæ”»å‡»å®ç° |
| `dataset_loader.py` | å¤šæ•°æ®é›†åŠ è½½å™¨ |
| `model_loader.py` | å¤šæ¨¡å‹åŠ è½½å™¨ |
| `run_full_experiments.py` | **å®Œæ•´å®éªŒçŸ©é˜µä¸»ç¨‹åº** â­ |

### æ–‡æ¡£

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `å®Œæ•´å®éªŒçŸ©é˜µä½¿ç”¨æŒ‡å—.md` | æœ¬æ–‡ä»¶ |
| `GPUä½¿ç”¨æŒ‡å—.md` | GPUåŠ é€Ÿè¯¦ç»†æŒ‡å— |

### è¾…åŠ©å·¥å…·

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `check_gpu.py` | GPUé…ç½®æ£€æŸ¥è„šæœ¬ |

---

## ğŸš€ GPUåŠ é€Ÿï¼ˆæ¨èï¼‰

### ğŸ’¡ ä¸ºä»€ä¹ˆè¦ç”¨GPUï¼Ÿ

ä½¿ç”¨GPUï¼ˆå¦‚RTX 4060ï¼‰ä¼šæ¯”CPUå¿«**5-10å€**ï¼

| ä»»åŠ¡ | CPU | GPU (RTX 4060) | åŠ é€Ÿæ¯” |
|------|-----|----------------|--------|
| RLè®­ç»ƒ (1ä¸‡æ­¥) | ~20åˆ†é’Ÿ | ~3åˆ†é’Ÿ | 6x |
| å®Œæ•´å®éªŒ (500æ ·æœ¬) | ~8å°æ—¶ | **~1.5å°æ—¶** | 5x |

### âœ… æ£€æŸ¥GPU

```bash
# è¿è¡ŒGPUæ£€æŸ¥è„šæœ¬
python check_gpu.py
```

**é¢„æœŸè¾“å‡ºï¼š**
```
ğŸ” GPUé…ç½®æ£€æŸ¥
1. CUDAæ˜¯å¦å¯ç”¨: True
2. CUDAç‰ˆæœ¬: 12.1
3. å½“å‰GPU: NVIDIA GeForce RTX 4060
ğŸš€ GPUåŠ é€Ÿ: 54.28x
âœ… GPUé…ç½®æ­£å¸¸ï¼å¯ä»¥è¿è¡Œå®éªŒäº†ï¼
```

### ğŸ¯ GPUä½¿ç”¨è¯´æ˜

âœ… **ä»£ç å·²é»˜è®¤ä½¿ç”¨GPU**ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼

è¿è¡Œæ—¶ä¼šçœ‹åˆ°ï¼š
```
ğŸš€ ä½¿ç”¨è®¾å¤‡: cuda  â† è¡¨ç¤ºä½¿ç”¨GPU
```

å¦‚æœæƒ³å¼ºåˆ¶ä½¿ç”¨CPUï¼ˆä¸æ¨èï¼‰ï¼š
```bash
python run_full_experiments.py --quick_test --no_gpu
```

ğŸ“– **è¯¦ç»†GPUä½¿ç”¨æŒ‡å—**ï¼šè¯·æŸ¥çœ‹ `GPUä½¿ç”¨æŒ‡å—.md`

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼1ï¼šå¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èå…ˆè¿è¡Œï¼‰

```bash
# å¿«é€Ÿæµ‹è¯•ï¼šCIFAR-10 + 2ä¸ªæ¨¡å‹ + 100æ ·æœ¬
python run_full_experiments.py --quick_test
```

**é¢„è®¡æ—¶é—´**ï¼š
- ğŸš€ GPU (RTX 4060): ~5åˆ†é’Ÿ
- ğŸ’» CPU: ~30åˆ†é’Ÿ

**å®éªŒæ•°**ï¼š2æ¨¡å‹ Ã— 4æ–¹æ³• = 8ä¸ªå®éªŒ

### æ–¹å¼2ï¼šå®Œæ•´å®éªŒ

```bash
# å®Œæ•´å®éªŒï¼šCIFAR-10 + 4ä¸ªæ¨¡å‹ + 500æ ·æœ¬
python run_full_experiments.py --full
```

**é¢„è®¡æ—¶é—´**ï¼š
- ğŸš€ GPU (RTX 4060): ~1.5å°æ—¶
- ğŸ’» CPU: ~8å°æ—¶

**å®éªŒæ•°**ï¼š4æ¨¡å‹ Ã— 4æ–¹æ³• = 16ä¸ªå®éªŒ

### æ–¹å¼3ï¼šå¤šæ•°æ®é›†å®éªŒ

```bash
# CIFAR-10 + CIFAR-100
python run_full_experiments.py --full --datasets cifar10 cifar100
```

**é¢„è®¡æ—¶é—´**ï¼š
- ğŸš€ GPU (RTX 4060): ~3å°æ—¶
- ğŸ’» CPU: ~16å°æ—¶

**å®éªŒæ•°**ï¼š2æ•°æ®é›† Ã— 4æ¨¡å‹ Ã— 4æ–¹æ³• = 32ä¸ªå®éªŒ

### æ–¹å¼4ï¼šè‡ªå®šä¹‰é…ç½®

```bash
# è‡ªå®šä¹‰æ ·æœ¬æ•°å’Œæ­¥æ•°
python run_full_experiments.py \
    --datasets cifar10 \
    --num_samples 300 \
    --max_steps 5 \
    --exp_dir results/my_experiment
```

---

## âš™ï¸ å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--quick_test` | å¿«é€Ÿæµ‹è¯•æ¨¡å¼ï¼ˆ100æ ·æœ¬ï¼Œ2æ¨¡å‹ï¼‰ | False |
| `--full` | å®Œæ•´å®éªŒæ¨¡å¼ï¼ˆ500æ ·æœ¬ï¼Œ4æ¨¡å‹ï¼‰ | False |
| `--datasets` | æ•°æ®é›†åˆ—è¡¨ | ['cifar10'] |
| `--num_samples` | æ ·æœ¬æ•°ï¼ˆè¦†ç›–é»˜è®¤å€¼ï¼‰ | æ ¹æ®æ¨¡å¼ |
| `--max_steps` | æœ€å¤§ä¿®æ”¹æ­¥æ•° | 5 |
| `--exp_dir` | å®éªŒç»“æœç›®å½• | results/full_experiments |
| `--no_gpu` | ä¸ä½¿ç”¨GPU | False |
| `--retrain` | é‡æ–°è®­ç»ƒRLæ™ºèƒ½ä½“ | False |

---

## ğŸ“Š è¾“å‡ºç»“æœ

### ç›®å½•ç»“æ„

```
results/full_experiments/
â”œâ”€â”€ all_stats.json              # æ‰€æœ‰å®éªŒçš„ç»Ÿè®¡ä¿¡æ¯
â”œâ”€â”€ summary_table.csv           # ç»¼åˆç»“æœè¡¨æ ¼
â”œâ”€â”€ models/                     # è®­ç»ƒçš„RLæ™ºèƒ½ä½“
â”‚   â”œâ”€â”€ agent_cifar10.zip
â”‚   â””â”€â”€ agent_cifar100.zip
â”œâ”€â”€ logs/                       # è¯¦ç»†çš„å®éªŒæ•°æ®
â”‚   â”œâ”€â”€ cifar10_resnet18_rl_v2_metrics.csv
â”‚   â”œâ”€â”€ cifar10_resnet18_jsma_metrics.csv
â”‚   â””â”€â”€ ...
â””â”€â”€ plots/                      # å¯è§†åŒ–å›¾è¡¨
    â”œâ”€â”€ asr_cifar10.png/pdf
    â”œâ”€â”€ asr_cifar100.png/pdf
    â””â”€â”€ ...
```

### ç»¼åˆè¡¨æ ¼ç¤ºä¾‹

```
Dataset  | Model       | Method      | ASR (%) | Avg L0 | Avg Time (s)
---------|-------------|-------------|---------|--------|-------------
cifar10  | resnet18    | rl_v2       | 89.0    | 0.00   | 0.09
cifar10  | resnet18    | jsma        | 96.0    | 0.25   | 0.04
cifar10  | resnet18    | one_pixel   | 97.0    | 1.00   | 1.31
cifar10  | resnet18    | sparsefool  | 92.0    | 0.50   | 0.20
...
```

---

## ğŸ”¬ å®éªŒçŸ©é˜µè¯´æ˜

### å®Œæ•´çŸ©é˜µï¼ˆ--fullæ¨¡å¼ï¼‰

```
æ•°æ®é›†ï¼ˆ2ä¸ªï¼‰ï¼š
â”œâ”€ CIFAR-10
â””â”€ CIFAR-100

æ¨¡å‹ï¼ˆ4ä¸ª/æ•°æ®é›†ï¼‰ï¼š
â”œâ”€ ResNet-18
â”œâ”€ VGG-16
â”œâ”€ MobileNetV2
â””â”€ DenseNet-121

æ–¹æ³•ï¼ˆ4ä¸ªï¼‰ï¼š
â”œâ”€ SparseAttackRL V2 (Ours)
â”œâ”€ JSMA Attack
â”œâ”€ One-Pixel Attack
â””â”€ SparseFool

æ ·æœ¬æ•°ï¼š500/æ•°æ®é›†

æ€»å®éªŒæ•° = 2 Ã— 4 Ã— 4 = 32ä¸ªå®éªŒç»„åˆ
```

### å¿«é€Ÿæµ‹è¯•çŸ©é˜µï¼ˆ--quick_testæ¨¡å¼ï¼‰

```
æ•°æ®é›†ï¼š1ä¸ªï¼ˆCIFAR-10ï¼‰
æ¨¡å‹ï¼š2ä¸ªï¼ˆResNet-18, MobileNetV2ï¼‰
æ–¹æ³•ï¼š4ä¸ª
æ ·æœ¬æ•°ï¼š100

æ€»å®éªŒæ•° = 1 Ã— 2 Ã— 4 = 8ä¸ªå®éªŒç»„åˆ
```

---

## ğŸ“ˆ è®ºæ–‡ä½¿ç”¨å»ºè®®

### å¿…é¡»å®éªŒ

1. **å®Œæ•´CIFAR-10å®éªŒ** â­â­â­
```bash
python run_full_experiments.py --full --datasets cifar10
```

2. **CIFAR-100éªŒè¯æ³›åŒ–èƒ½åŠ›** â­â­â­
```bash
python run_full_experiments.py --full --datasets cifar10 cifar100
```

### å¯é€‰å®éªŒ

3. **ImageNetå®éªŒ**ï¼ˆå¦‚æœæœ‰èµ„æºï¼‰â­â­
```bash
python run_full_experiments.py --full --datasets cifar10 cifar100 imagenet
```

4. **æ¶ˆèå®éªŒ** â­â­
```bash
python ablation_study.py
```

---

## ğŸ“ è®ºæ–‡è¡¨æ ¼ç”Ÿæˆ

### è¡¨1ï¼šä¸»è¦ç»“æœï¼ˆCIFAR-10ï¼‰

ä» `summary_table.csv` ä¸­æå– CIFAR-10 çš„ç»“æœï¼š

```latex
\begin{table}[h]
\centering
\caption{Attack Performance on CIFAR-10}
\begin{tabular}{lcccc}
\hline
Model & Method & ASR (\%) & Avg. L0 & Time (s) \\
\hline
\multirow{4}{*}{ResNet-18} 
  & SparseAttackRL V2 (Ours) & 89.0 & X.XX & 0.09 \\
  & JSMA & 96.0 & X.XX & 0.04 \\
  & One-Pixel & 97.0 & 1.00 & 1.31 \\
  & SparseFool & 92.0 & X.XX & 0.20 \\
\hline
... (å…¶ä»–æ¨¡å‹)
\end{tabular}
\end{table}
```

### è¡¨2ï¼šè·¨æ•°æ®é›†æ³›åŒ–

ä» `summary_table.csv` ä¸­æå–æ‰€æœ‰æ•°æ®é›†çš„å¹³å‡ç»“æœã€‚

### è¡¨3ï¼šæ¶ˆèå®éªŒ

è¿è¡Œ `ablation_study.py` ç”Ÿæˆã€‚

---

## âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨GPUåŠ é€Ÿ

```bash
# ç¡®ä¿CUDAå¯ç”¨
python -c "import torch; print(torch.cuda.is_available())"

# è¿è¡Œå®éªŒ
python run_full_experiments.py --full  # é»˜è®¤ä½¿ç”¨GPU
```

### 2. å¹¶è¡Œè¿è¡Œï¼ˆå¦‚æœæœ‰å¤šGPUï¼‰

```bash
# åˆ†åˆ«åœ¨ä¸åŒGPUä¸Šè¿è¡Œä¸åŒæ•°æ®é›†
CUDA_VISIBLE_DEVICES=0 python run_full_experiments.py --full --datasets cifar10 &
CUDA_VISIBLE_DEVICES=1 python run_full_experiments.py --full --datasets cifar100 &
```

### 3. åˆ†é˜¶æ®µè¿è¡Œ

```bash
# é˜¶æ®µ1ï¼šå¿«é€Ÿæµ‹è¯•éªŒè¯ä»£ç 
python run_full_experiments.py --quick_test

# é˜¶æ®µ2ï¼šCIFAR-10å®Œæ•´å®éªŒ
python run_full_experiments.py --full --datasets cifar10

# é˜¶æ®µ3ï¼šæ·»åŠ CIFAR-100
python run_full_experiments.py --full --datasets cifar100
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: GPUå†…å­˜ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ä½¿ç”¨CPU
python run_full_experiments.py --full --no_gpu

# æˆ–å‡å°‘æ ·æœ¬æ•°
python run_full_experiments.py --num_samples 200
```

### Q2: ImageNetæ•°æ®é›†æœªæ‰¾åˆ°

**è¯´æ˜**ï¼šImageNetéœ€è¦æ‰‹åŠ¨ä¸‹è½½

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä¸‹è½½ImageNetéªŒè¯é›†
2. è§£å‹åˆ° `./data/imagenet/val/`
3. æˆ–è€…è·³è¿‡ImageNetï¼š
```bash
python run_full_experiments.py --full --datasets cifar10 cifar100
```

### Q3: å®éªŒæ—¶é—´å¤ªé•¿

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å‡å°‘æ ·æœ¬æ•°
python run_full_experiments.py --num_samples 200

# æˆ–ä½¿ç”¨å¿«é€Ÿæµ‹è¯•å…ˆéªŒè¯
python run_full_experiments.py --quick_test
```

### Q4: RLè®­ç»ƒæ•ˆæœä¸å¥½

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å¢åŠ è®­ç»ƒæ­¥æ•°ï¼ˆä¿®æ”¹ä»£ç ä¸­çš„train_timestepsï¼‰
# æˆ–é‡æ–°è®­ç»ƒ
python run_full_experiments.py --full --retrain
```

---

## ğŸ“Š ç»“æœåˆ†æ

### 1. æŸ¥çœ‹ç»¼åˆè¡¨æ ¼

```bash
# åœ¨Excel/Numbersä¸­æ‰“å¼€
open results/full_experiments/summary_table.csv
```

### 2. æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯

```python
import json
with open('results/full_experiments/all_stats.json', 'r') as f:
    stats = json.load(f)
    
# æŸ¥çœ‹æŸä¸ªå®éªŒçš„ç»Ÿè®¡
print(stats['cifar10_resnet18_rl_v2'])
```

### 3. è‡ªå®šä¹‰åˆ†æ

```python
import pandas as pd

# åŠ è½½è¡¨æ ¼
df = pd.read_csv('results/full_experiments/summary_table.csv')

# æŒ‰æ–¹æ³•åˆ†ç»„
grouped = df.groupby('Method')['ASR (%)'].mean()
print(grouped)

# æŒ‰æ¨¡å‹åˆ†ç»„
grouped = df.groupby('Model')['ASR (%)'].mean()
print(grouped)
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### è®ºæ–‡å®éªŒæµç¨‹

1. **ç¬¬1å¤©ï¼šå¿«é€Ÿæµ‹è¯•**
```bash
python run_full_experiments.py --quick_test
```
éªŒè¯ä»£ç æ— è¯¯ï¼Œç†Ÿæ‚‰è¾“å‡ºæ ¼å¼ã€‚

2. **ç¬¬2å¤©ï¼šCIFAR-10å®Œæ•´å®éªŒ**
```bash
python run_full_experiments.py --full --datasets cifar10
```
è·å–ä¸»è¦ç»“æœã€‚

3. **ç¬¬3å¤©ï¼šCIFAR-100éªŒè¯**
```bash
python run_full_experiments.py --full --datasets cifar100
```
è¯æ˜æ³›åŒ–èƒ½åŠ›ã€‚

4. **ç¬¬4å¤©ï¼šæ¶ˆèå®éªŒ**
```bash
python ablation_study.py
```
åˆ†æå„ç»„ä»¶è´¡çŒ®ã€‚

5. **ç¬¬5å¤©ï¼šåˆ†æå’Œå†™ä½œ**
- ç”Ÿæˆè®ºæ–‡è¡¨æ ¼å’Œå›¾è¡¨
- ç»Ÿè®¡æ˜¾è‘—æ€§åˆ†æ
- æ’°å†™å®éªŒç« èŠ‚

---

## ğŸ“ å¼•ç”¨æ ¼å¼

å¦‚æœä½¿ç”¨SparseFoolï¼Œéœ€è¦å¼•ç”¨ï¼š

```bibtex
@inproceedings{modas2019sparsefool,
  title={SparseFool: a few pixels make a big difference},
  author={Modas, Apostolos and Moosavi-Dezfooli, Seyed-Mohsen and Frossard, Pascal},
  booktitle={CVPR},
  year={2019}
}
```

---

## ğŸ‰ æ€»ç»“

ä½ ç°åœ¨æ‹¥æœ‰ï¼š

âœ… **å®Œæ•´çš„å®éªŒæ¡†æ¶**
- æ”¯æŒå¤šæ•°æ®é›†ã€å¤šæ¨¡å‹ã€å¤šæ–¹æ³•
- è‡ªåŠ¨åŒ–è¿è¡Œæ‰€æœ‰ç»„åˆ
- ç»Ÿä¸€çš„ç»“æœæ ¼å¼

âœ… **è®ºæ–‡æ‰€éœ€çš„æ‰€æœ‰å®éªŒ**
- ä¸»è¦ç»“æœï¼ˆè¡¨æ ¼+å›¾è¡¨ï¼‰
- è·¨æ•°æ®é›†éªŒè¯
- å¤šæ¨¡å‹å¯¹æ¯”

âœ… **é«˜è´¨é‡çš„è¾“å‡º**
- CSVè¡¨æ ¼ï¼ˆå¯ç›´æ¥ç”¨äºè®ºæ–‡ï¼‰
- PDF/PNGå›¾è¡¨ï¼ˆè®ºæ–‡çº§è´¨é‡ï¼‰
- JSONæ•°æ®ï¼ˆä¾¿äºåç»­åˆ†æï¼‰

**ç¥è®ºæ–‡å‘è¡¨é¡ºåˆ©ï¼** ğŸš€ğŸ“

